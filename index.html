<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>うちの子コンシェルジュ 登録ページ</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    console.log("🔵 LIFF開始");

    await liff.init({ liffId: LIFF_ID });
    console.log("🟢 LIFF初期化完了");

    if (!liff.isLoggedIn()) {
      console.log("🟡 未ログイン。ログイン開始");
      liff.login();
      return;
    }

    console.log("🟢 ログイン済み。プロフィール取得中…");
    const profile = await liff.getProfile();
    console.log("🟢 プロフィール取得成功", profile);

    const userId = profile.userId;

    fetch(GAS_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ userId })
    }).then(() => {
      console.log("✅ userIdを送信し、Googleフォームへ移動します");
      window.location.href = "https://forms.gle/D1xXTAmrYYknzhBV7";
    }).catch(err => {
      console.error("❌ GAS送信エラー:", err);
      alert("エラーが発生しました。しばらくしてからお試しください。");
    });
  }


    main();
  </script>
</head>
<body>
  <p>LINEでログイン中です。Googleフォームに移動します...</p>
</body>
</html>


